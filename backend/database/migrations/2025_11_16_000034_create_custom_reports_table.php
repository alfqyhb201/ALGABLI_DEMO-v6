<?php use Illuminate\Database\Migrations\Migration; use Illuminate\Database\Schema\Blueprint; use Illuminate\Support\Facades\Schema; class CreateCustomReportsTable extends Migration { public function up() { Schema::create('custom_reports', function (Blueprint $table) { $table->char('id',36)->primary(); $table->char('base_report_id',36)->nullable(); $table->unsignedBigInteger('created_by')->nullable(); $table->string('name'); $table->text('description')->nullable(); $table->json('data_sources')->nullable(); $table->json('selected_fields')->nullable(); $table->json('filters')->nullable(); $table->json('group_by')->nullable(); $table->json('having')->nullable(); $table->json('order_by')->nullable(); $table->enum('visualization_type', ['table','chart','pivot','map'])->default('table'); $table->integer('refresh_interval')->nullable(); $table->timestamp('last_refreshed_at')->nullable(); $table->json('shared_with')->nullable(); $table->boolean('is_public')->default(false); $table->timestamps(); $table->foreign('base_report_id')->references('id')->on('reports')->onDelete('set null'); $table->foreign('created_by')->references('id')->on('users')->onDelete('set null'); }); } public function down() { Schema::dropIfExists('custom_reports'); } }
