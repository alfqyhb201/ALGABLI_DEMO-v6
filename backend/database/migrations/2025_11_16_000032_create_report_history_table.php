<?php use Illuminate\Database\Migrations\Migration; use Illuminate\Database\Schema\Blueprint; use Illuminate\Support\Facades\Schema; class CreateReportHistoryTable extends Migration { public function up() { Schema::create('report_history', function (Blueprint $table) { $table->bigIncrements('id'); $table->char('report_id',36); $table->unsignedBigInteger('generated_by')->nullable(); $table->enum('export_format', ['pdf','excel','csv','json'])->default('json'); $table->timestamp('generated_at')->nullable(); $table->integer('duration_ms')->nullable(); $table->enum('status', ['success','failed'])->default('success'); $table->text('error_message')->nullable(); $table->timestamps(); $table->foreign('report_id')->references('id')->on('reports')->onDelete('cascade'); $table->foreign('generated_by')->references('id')->on('users')->onDelete('set null'); }); } public function down() { Schema::dropIfExists('report_history'); } }
